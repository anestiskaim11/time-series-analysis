# ΑΝΑΛΥΣΗ ΧΡΟΝΟΣΕΙΡΩΝ

## 7ο Εξάμηνο - Τμήμα Ηλεκτρολόγων Μηχανικών και Μηχανικών Υπολογιστών ΑΡΙΣΤΟΤΕΛΕΙΟ ΠΑΝΕΠΙΣΤΗΜΙΟ ΘΕΣΣΑΛΟΝΙΚΗΣ


### Στόχος της Εργασίας
Στην υπολογιστική εργασία του μαθήματος των Χρονοσειρών, σκοπός μας είναι να
επεξεργαστούμε πραγματικά δεδομένα, να προσπαθήσουμε να σχηματίσουμε προβλέψεις
χρησιμοποιώντας γραμμικά μοντέλα και ύστερα να αξιολογήσουμε κατά πόσα αυτά είναι ικανά να
δίνουν συνεπείς προβλέψεις. Για τα πειράματα μας χρησιμοποιήσαμε τις σημειώσεις του
μαθήματος και, κατά ένα μεγάλο μέρος, τον κώδικα των εργαστηρίων.

Η ομάδα μας αποφάσισε να χρησιμοποιήσει τις πρώτες 350 παρατηρήσεις των dataset
MGD100D200D300 και MGD50D75D100 από το AUTH EEG Analysis group. Παρακάτω είναι τα
αποτελέσματα της γραμμικής και μη-γραμμικής ανάλυσης για κάθε ένα από αυτά.

### Γραμμική Ανάλυση
Και για τις δύο χρονοσειρές χρησιμοποιήθηκε, ύστερα από δοκιμές, φίλτρο κινούμενου μέσου με
πλήθος 10, για την απαλοιφή της τάσης.
<img width="959" alt="Screenshot 2022-03-26 at 8 54 53 PM" src="https://user-images.githubusercontent.com/81708900/160253335-80a839ad-ed80-4488-bb3a-b727cd59b3cd.png">


Για να σταθεροποιηθεί η διασπορά και να φέρουμε τα δείγματα μας πιο κοντά σε στάσιμες
διαδικασίες δοκιμάσαμε πρώτες, δεύτερες και τρίτες διαφορές και στα δύο σύνολα. Οι νέοι μέσοι
όροι και οι γραφικές παραστάσεις μας επιτρέπουν να συνεχίσουμε τους υπολογισμούς και τις
προβλέψεις μας με τις πρώτες διαφορές των χρονοσειρών:

Οι πρώτες διαφορές για το
MGD50D75D100 δίνουν
μέσο όρο -0.001099,
αρκετά κοντά στο μηδέν
ώστε να θεωρηθεί μη
στατιστικά σημαντικός.

![MGD50D75D100-diff](https://user-images.githubusercontent.com/81708900/160253388-20c6f129-db65-48e7-88ad-00e14c5e7acd.png)

Ακριβώς το ίδιο συμβαίνει
και για το
MGD100D200D300, που
εμφανίζει μέσο όρο
-0.000787

![MGD100D200D300-diff](https://user-images.githubusercontent.com/81708900/160253395-f92fa73d-236f-4bfa-87fa-85faf4722a34.png)

Καμία από τις δύο χρονοσειρές έδειξε να παρουσιάζει κάποια μορφή εύκολα διαχειρίσιμης ή
χρήσιμης περιοδικότητας. Γι’ αυτό και η απαλοιφή περιοδικών συνιστωσών δεν προτιμήθηκε.

Τώρα, ακολουθώντας την παράγραφο 4.3 των σημειώσεων της θεωρίας, και έχοντας επιλέξει να
προβλέψουμε μελλοντικές τιμές προσαρμόζοντας στα δεδομένα μας μοντέλο ARIMA(p, 1, q), δε
συμβουλευτήκαμε τις αυτοσυσχετίσεις και μερικές αυτοσυσχετίσεις αλλά το κριτήριο AIC. Πιο
συγκεκριμένα, για όλα τα πιθανά ζεύγη τιμών p και q από 1 μέχρι 10, εξήγαμε το AIC, και κρατήσαμε
το μοντέλο για το οποίο το κριτήριο ήταν το ελάχιστο. Και για τα δύο μοντέλα, εξαιτίας της,
φαινομενικά μη γραμμικής, φύσης των δεδομένων, το μοντέλο που επιλέχθηκε ήταν ARIMA(2, 1, 3).
Σημείωση: Στον κώδικα της ανάλυσης, το μοντέλο που φαίνεται να επιλέγεται είναι ARIMA(2, 0, 3).
Αυτό συμβαίνει επειδή το μοντέλο προσαρμόστηκε πάνω στη νέα χρονοσειρά των πρώτων
διαφορών, η οποία είναι προϊόν του pre-processing των αρχικών δεδομένων.


<img width="586" alt="Screenshot 2022-03-26 at 8 59 02 PM" src="https://user-images.githubusercontent.com/81708900/160253478-4658f72f-5d54-4013-b6f4-d8fa414fc759.png">



### Out of sample προβλέψεις
Τα γραμμικά μοντέλα πρόβλεψης εκπαιδεύθηκαν με το 90% των παρατηρήσεων και ο έλεγχος έγινε
με το τελευταίο 10%, που αντιστοιχεί σε 34 τιμές. Οι προβλέψεις γίνονται για τις πρώτες διαφορές και
αναδρομικά προστίθενται στις προηγούμενες τιμές που έχουν προκύψει. Έτσι έχουμε:

<img width="566" alt="Screenshot 2022-03-26 at 9 00 58 PM" src="https://user-images.githubusercontent.com/81708900/160253530-7c2d3fde-6de3-4bde-ba12-7cdcd177f718.png">

Εύκολα γίνεται αντιληπτό πως η περιοχή αποτελεσματικών προβλέψεων είναι πολύ πιο βραχεία για
το πρώτο μοντέλο, το οποίο δείχνει να αποκλίνει. Το αντίθετο όμως συμβαίνει στη δεύτερη
περίπτωση, όπου οι προβλέψεις δείχνουν να ακολουθούν με ικανοποιητική συνέπεια τις
πραγματικές τιμές.

### Μη-γραμμική ανάλυση
Σε αυτό το σημείο, πρέπει να οριστικοποιήσουμε αν το παραγόμενο γραμμικό μοντέλο είναι η
καλύτερη προσπάθεια που μπορούμε να κάνουμε για να προβλέψουμε τις δοθείσες χρονοσειρές.
Έτσι, μελετάμε τη χρονοσειρά που προκύπτει από τα υπόλοιπα προσαρμογής του μοντέλου πάνω
στη χρονοσειρά που έχουμε μετατρέψει σε στάσιμη. Στη δική μας περίπτωση, αυτές είναι οι πρώτες
διαφορές. Παράγουμε ακόμα 40 χρονοσειρές με τυχαία αντιμετάθεση της αρχικής και εξάγουμε
γραμμικά κα μη-γραμμικά στατιστικά:


* Τις αυτοσυσχετίσεις για τις πρώτες 10 υστερήσεις
* Τις αντίστοιχες μερικές αυτοσυσχετίσεις
* Τις διαστάσεις συσχέτισης για m = 1, ..., 5

Για να αποφασίσουμε αν η τελική διαδικασία είναι γραμμική ή περιέχει μη-γραμμικά στοιχεία, που η
γραμμική ανάλυση αδυνατεί να εντοπίσει, υπολογίζουμε τα παραπάνω στατιστικά για όλες τις
χρονοσειρές και κοιτάμε που βρίσκονται τα αντίστοιχα στατιστικά της αρχικής διαδικασίας. Γι’ αυτό
το λόγο, παράγουμε δύο arrays, ένα με τα μέγιστα αυτών των στατιστικών κι ένα με τα ελάχιστα. Αν
η αρχική διαδικασία βρίσκεται εντός αυτών των ορίων, συμπεραίνουμε πως η επεξεργασία των
δεδομένων μας οδήγησε σε γραμμικότητα. Η μεθοδολογία αυτή μας έδωσε:

![MGD50D75D100-acf-int](https://user-images.githubusercontent.com/81708900/160253599-633cb65c-6ff8-4f36-ade3-795a3c499371.png)

![MGD50D75D100-embdim-int](https://user-images.githubusercontent.com/81708900/160253600-8aa7ff36-41c9-4502-9924-3f91f016d0a8.png)

![MGD50D75D100-pacf-int](https://user-images.githubusercontent.com/81708900/160253605-48a25018-007a-47f5-870c-d07bfa7ba48b.png)


Αν και θα μπορούσαμε να πούμε πως οι
αυτοσυσχετίσεις και μερικές αυτοσυσχετίσεις για
το MGD50D75D100 παρουσιάζουν, ενδεχομένως,
μη σημαντικές διαφορές, η αντίστοιχη διερεύνηση
στη διάσταση συσχέτισης δε μας επιτρέπει να
θεωρήσουμε πως έχουμε εξάγει όλη τη χρήσιμη
πληροφορία μέσω της γραμμικής ανάλυσης.

Ακριβώς τα ίδια συμπεράσματα εξάγουμε και για
τη μελέτη του MGD100D200D300.

![MGD100D200D300-acf-int](https://user-images.githubusercontent.com/81708900/160253631-af84606b-37c8-49dd-9f4e-281614f3a133.png)

![MGD100D200D300-embdim-int](https://user-images.githubusercontent.com/81708900/160253634-732afa1a-767c-40db-a49c-1f2f580ce2cd.png)

![MGD100D200D300-pacf-int](https://user-images.githubusercontent.com/81708900/160253638-8bd263e3-1c46-4b28-984d-d3a490bee6e1.png)


Καϊμακαμίδης Ανέστης – 9627 - anestisk@ece.auth.gr
Αντωνίου Αντώνιος – 9482 – aantonii@ece.auth.gr
